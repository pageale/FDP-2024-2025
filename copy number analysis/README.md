# Copy Number Analysis
This folder contains scripts for processing and analyzing copy number alteration (CNA) data, specifically using outputs from [ichorCNA](https://github.com/broadinstitute/ichorCNA).

## Contents
* **extract_ichor_info.py:** Extracts summary information from ichorCNA output.
* **correlation.R** Performs Pearson correlation analysis and generates plots for tumor fraction estimates and CNA bins.

## Usage
* **extract_ichor_info.py**: This script converts ichorCNA output files into a single summary table containing the following columns for each sample:
  * SampleName
  * TumorFraction
  * Ploidy
  * SubcloneFraction
  * SubcloneGenomeFraction
  * FractionCNASubclonal

  **Input:** A folder containing all *.params.txt files generated by ichorCNA.
  
  **Output:** A CSV table with the extracted metrics.

  **Command:**
  ```
  python3 extract_ichor_info.py input_folder/ paht/to/table.csv
  ```
***
* **correlation.R**: This R script performs a Pearson correlation analysis and generates visualizations for:
  * Tumor fraction correlations.
  * Correlations of bin-level CNA estimates.

  **Inputs:**
  * *.cna.seg files generated by ichorCNA.
  *  CSV file containing tumor fraction estimates with corresponding sample IDs.
  
   **Libraries**:
    ```R
    library(ggpubr)
    library(dplyr)
    library(readr)
    library(ggrepel)
    library(ggplot2)
    library(vctrs)
    library(purrr)
    ```

  **Instalation**
    
    You can install the required R packages by running:
    
    ```R
    install.packages(c("ggpubr", "dplyr", "readr", "ggrepel", "ggplot2", "vctrs", "purrr"))
    ``` 
***



